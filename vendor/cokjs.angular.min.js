var cokAngular=angular.module("cokjs.angular",["ui.bootstrap"]);!function(a){"use strict";var b='<div class="modal-header">    <h3 class="modal-title">发生错误</h3></div><div class="modal-body">    <div class="container-fluid">        <div class="row">            <div class="col-xs-12">                <div class="error-message">                    {{error.message}}                </div>            </div>        </div>    </div></div><div class="modal-footer">    <button class="btn btn-primary" ng-click="ok()">确 定</button></div>';a.module("cokjs.angular").factory("cokModalSvr",["$modal",function(a){var c=a;return c.showError=function(c,d){var e={resolve:{error:function(){return c}},controller:function(a,b,c){a.error=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}},size:"sm"};null!=d&&"undefined"!=typeof d?e.templateUrl=d:e.template=b;a.open(e)},c.showForm=function(c,d,e){var f={resolve:c,controller:function(a,b,c){a.error=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}},size:"sm"};null!=d&&"undefined"!=typeof d?f.templateUrl=d:f.template=b,null!=e&&"undefined"!=typeof e&&(f.controller=e);a.open(f)},c}])}(angular),function(a,b){"use strict";a.module("cokjs.angular").provider("cokUtilSvr",function(){this.isEmpty=function(a){if(null==a||"undefined"==typeof a)return!0;if("object"==typeof a){for(var b in a)return!1;return!0}return!1},this.getQueryString=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null},this.getWinSize=function(){if(window.innerWidth!=b)return{width:window.innerWidth,height:window.innerHeight};var a=document.body,c=document.documentElement;return{width:Math.max(c.clientWidth,a.clientWidth),height:Math.max(c.clientHeight,a.clientHeight)}};var a={};a.isEmpty=this.isEmpty,a.getQueryString=this.getQueryString,a.getWinSize=this.getWinSize,this.$get=function(){return a}})}(angular),angular.module("cokjs.angular").provider("WebSocket",function(){var a,b,c,d="websocket:",e=[];this.prefix=function(a){return d=a,this},this.uri=function(d,e){return e=Array.prototype.slice.call(arguments,1),b=d,c=e,a=new WebSocket(d,e),this},this.$get=["$rootScope","$timeout",function(f,g){var h=a,i=function(a){return function(b){b=Array.prototype.slice.call(arguments),g(function(){a.apply(h,b)})}},j=function(a){return a=a&&"on"+a||"onmessage",function(b){return h[a]=i(b),e.push(a),this}},k={states:["CONNECTING","OPEN","CLOSING","CLOSED"],on:function(a,b){return j(a)(b)},onmessage:j("message"),onclose:j("close"),onopen:j("open"),onerror:j("error"),close:function(){return h.close(),this},readyState:function(){return h.readyState},currentState:function(){return this.states[h.readyState]},send:function(a){return a=Array.prototype.slice.call(arguments),h.send.apply(h,a),this},removeListener:function(a){return a=Array.prototype.slice.call(arguments),h.removeEventListener.apply(h,a),this},forward:function(a,b){return a instanceof Array==!1&&(a=[a]),b||(b=f),a.forEach(function(a){var c=d+a,e=i(function(a){b.$broadcast(c,a)});b.$on("$destroy",function(){h.removeEventListener(a,e)}),h.onmessage(a,e)}),this}};return k["new"]=function(){var a=h;h=new WebSocket(b,c);for(var d,f=0,d=e.length;d>f;f++)h[e[f]]=a[e[f]];return this},k}]}),angular.module("cokjs.angular").directive("cokEnter",function(){return function(a,b,c){b.bind("keypress",function(b){13==b.which&&(a.$apply(function(){a.$eval(c.cokEnter)}),b.preventDefault())})}}),angular.module("cokjs.angular").directive("cokResizeHeight",["$window","cokUtilSvr",function(a,b){return function(c,d,e){var f=angular.element(a);c.getWindowDimensions=function(){var a=b.getWinSize();return{h:a.height}},c.offset=parseInt(e.cokResizeHeight),c.$watch(c.getWindowDimensions,function(a){c.height=function(){return{height:a.h+c.offset+"px"}},d.css(c.height())},!0),f.bind("resize",function(){c.$apply()})}}]),function(a,b){"use strict";a.module("cokjs.angular").directive("cokScroll",["$parse",function(a){function c(a){var b=a;return{getValue:function(){return b},setValue:function(a){b=a}}}function d(a,b){return{getValue:function(){return a(b)},setValue:function(){}}}function e(a,b,c){return{getValue:function(){return a(c)},setValue:function(d){d!==a(c)&&c.$apply(function(){b(c,d)})}}}function f(f,g){if(""!==f){var h=a(f);return h.assign!==b?e(h,h.assign,g):d(h,g)}return c(!0)}return{priority:1,restrict:"A",scope:!0,link:function(a,b,c){function d(){i.scrollTop=i.scrollHeight}function e(){j.getValue()&&d()}function g(){return!0}function h(){j.setValue(g())}var i=b[0],j=f(c.cokScroll,a);a.$watch(function(){return b[0].innerHTML.length},e),b.bind("scroll",h)}}}])}(angular);